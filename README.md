# ros2_maze
This repository is for ROS2 humble project. 
Started from final lab in ECE7785 course, Georgia Tech but this is revised with NAV2 and TF2.

## environment
- ROS2 humble, gazebo, Turtlebot3
- Python3(scipy, opencv, numpy, sklearn)

## algorithm
- Image Classification: k-nearest neighbors (KNN) and Decision Tree with RGB camera
- Localization: Particle Filter with LiDAR
- Controller: Regulated Pure Pursuit

## instruction
1. ros2 launch turtlebot3_gazebo turtlebot3_maze.launch.py use_sim_time:=true
2. ros2 launch turtlebot3_navigation2 navigation2.launch.py map:=$HOME/ros2_ws/map.yaml
3. 2D pose estimation on rviz2
3. ros2 run ros2_maze getObjectRange
4. ros2 run ros2_maze imageClassifier
5. ros2 run ros2_maze goToGoal
(alternatively, 3-5 can be replaced with ros2 launch ros2_maze go.launch.py)

## description
Turtlebot3 navigates the maze to get to the goal where each wall has a sign to let the robot know the direction to the goal.
6 different kinds of signs exist such as empty wall, left, right, do not enter, stop, and goal(star sign). The raspberry camera takes a photo of the sign and then classify with ML algorithm on the robot. To move the next wall, NAV2 and its controller are used. Thus, from the start point to the goal, the robot finds a way autonomously by continuously publishing goal_pose and subscribing navigate_to_pose status.


## demonstration
https://github.com/JunghoYoo/ros2_maze/assets/10891644/6661f613-a2e8-4cf8-909c-d66cde0a91ce


### files
src/goToGoal.py : main control with state machine and NAV2.
Direction to go is determined by image_clasification service. Distance to the next sign is measured by the lidar object_range topic.
Robots and goal coordination are converted with TF2. 

src/imageClassifier.py : from /camera/image_raw topic, classify an image when image_clasification service is requested

src/getObjectRange.py : by subscribing /scan topic, this arranges the sequence of lidar data and handle NaN value. Preprocessed lidar data is published to object_range.

resource/burger.yaml : navigation2 configuration file

resource/map.pgm : map file which was generated by Turtlebot3 SLAM(turtlebot3_cartographer)

resource/map.yaml : map file which was generated by Turtlebot3 SLAM(turtlebot3_cartographer)

### install packages
tf_transformations, python-transforms3d-pip, transforms3d

### gazebo environment reference
https://github.com/Jackson-Crandell/7785_Gazebo_Environments

### other reference
https://navigation.ros.org/index.html
https://navigation.ros.org/configuration/packages/configuring-regulated-pp.html
https://emanual.robotis.com/docs/en/platform/turtlebot3/nav_simulation/
